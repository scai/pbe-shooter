<?xml version="1.0" encoding="utf-8"?>
<things version="1">
	<entity name="spatialManager">
		<component type="com.pblabs.rendering2D.BasicSpatialManager2D"
			name="manager" />
	</entity>

	<entity name="scene">
		<component type="com.pblabs.rendering2D.DisplayObjectScene"
			name="scene">
			<sceneViewName>sceneView</sceneViewName>
			<position>
				<x>0</x>
				<y>0</y>
			</position>
		</component>
	</entity>

	<template name="bullet">
		<component type="com.pblabs.rendering2D.SimpleShapeRenderer"
			name="render">
			<scene entityName="scene" componentName="scene" />
			<fillColor>0xFFFFFF</fillColor>
			<lineColor>0xFFFFFF</lineColor>
			<isSquare>true</isSquare>
			<lineSize>2</lineSize>
			<layerIndex>2</layerIndex>
			<alpha>0</alpha>
			<positionProperty>@spatial.position</positionProperty>
			<sizeProperty>@spatial.size</sizeProperty>
		</component>
		<component type="com.pblabs.rendering2D.SimpleSpatialComponent"
			name="spatial">
			<spatialManager entityName="spatialManager" />
			<velocity>
				<x>0</x>
				<y>-500</y>
			</velocity>
			<size>
				<x>5</x>
				<y>5</y>
			</size>
			<objectMask>
				<typeName>bullet</typeName>
			</objectMask>
		</component>
		<component type="com.caichoi.BulletController" name="controller">
			<render componentName="render" />
			<spatial componentName="spatial" />
			<active>false</active>
		</component>
	</template>

	<!-- player jet -->
	<entity name="player">

		<!-- sprite sheet -->
		<component type="com.pblabs.rendering2D.spritesheet.SpriteSheetComponent"
			name="animatedSpriteSheet">
			<divider type="com.pblabs.rendering2D.spritesheet.CellCountDivider">
				<xCount>1</xCount>
				<yCount>4</yCount>
			</divider>
			<image filename="assets/plane-turn.png" />
		</component>

		<!-- view -->
		<component type="com.pblabs.rendering2D.SpriteSheetRenderer"
			name="render">
			<scene entityName="scene" componentName="scene" />
			<spriteSheet componentName="animatedSpriteSheet" />
			<spriteIndex>0</spriteIndex>
			<positionProperty>@spatial.position</positionProperty>
			<sizeProperty>@spatial.size</sizeProperty>
		</component>

		<!-- spatial -->
		<component type="com.pblabs.rendering2D.SimpleSpatialComponent"
			name="spatial">
			<spatialManager entityName="spatialManager" />
			<size>
				<x>50</x>
				<y>50</y>
			</size>
			<position>
				<x>0</x>
				<y>250</y>
			</position>
			<objectMask>
				<typeName>player</typeName>
			</objectMask>
		</component>

		<!-- keyboard input -->
		<component type="com.caichoi.KeyboardInput" name="keyboardInput">
			<inputMap childType="com.pblabs.engine.core.InputKey">
				<up>W</up>
				<down>S</down>
				<left>A</left>
				<right>D</right>
				<shoot>J</shoot>
			</inputMap>
		</component>

		<!-- controller -->
		<component type="com.caichoi.PlayerController" name="controller">
			<keyboardInput componentName="keyboardInput" />
			<spatial componentName="spatial" />
			<render componentName="render" />
			<shootInterval>0.1</shootInterval>
		</component>
	</entity>

    <!------------------------- enemy --------------------------------------->
    <template name="enemy">

        <!-- sprite sheet -->
        <component type="com.pblabs.rendering2D.spritesheet.SpriteSheetComponent"
            name="animatedSpriteSheet">
            <divider type="com.pblabs.rendering2D.spritesheet.CellCountDivider">
                <xCount>1</xCount>
                <yCount>6</yCount>
            </divider>
            <image filename="assets/enemy-sprite.png" />
        </component>

        <!-- animator -->
        <component type="com.pblabs.animation.AnimatorComponent"
            name="spriteAnimations">
            <animations childType="com.pblabs.animation.Animator">
                <idle>
                    <animationType>LOOP_ANIMATION</animationType>
                    <duration>2</duration>
                    <repeatCount>-1</repeatCount>
                    <startValue type="int">3</startValue>
                    <targetValue type="int">6</targetValue>
                </idle>
                <hit>
                    <animationType>LOOP_ANIMATION</animationType>
                    <duration>0.4</duration>
                    <repeatCount>1</repeatCount>
                    <startValue type="int">0</startValue>
                    <targetValue type="int">3</targetValue>
                </hit>
            </animations>
            <defaultAnimation>idle</defaultAnimation>
            <reference>@render.spriteIndex</reference>
        </component>

        <!-- view -->
        <component type="com.pblabs.rendering2D.SpriteSheetRenderer"
            name="render">
            <scene entityName="scene" componentName="scene" />
            <spriteSheet componentName="animatedSpriteSheet" />
            <layerIndex>10</layerIndex>
            <positionProperty>@spatial.position</positionProperty>
            <sizeProperty>@spatial.size</sizeProperty>
        </component>

        <!-- spatial -->
        <component type="com.pblabs.rendering2D.SimpleSpatialComponent"
            name="spatial">
            <spatialManager entityName="spatialManager" />
            <size>
                <x>30</x>
                <y>30</y>
            </size>
            <objectMask>
                <typeName>enemy</typeName>
            </objectMask>
        </component>

        <!-- health -->
        <component type="com.caichoi.EnemyHealth" name="health">
        </component>
    </template>
    
	<group name="main">
		<objectReference name="spatialManager" />
		<objectReference name="scene" />
		<objectReference name="player" />
	</group>
</things>